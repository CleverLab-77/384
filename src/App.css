*{box-sizing:border-box}
html,body,#root{height:100%}
body{margin:0;background:url('/background.png') center/cover no-repeat;color:#2c2c2c;font-family:"Courier New", monospace;image-rendering:pixelated;image-rendering:-moz-crisp-edges;image-rendering:crisp-edges}
#root{display:flex;align-items:center;justify-content:center}
.app{width:100vw;height:100vh;margin:0;border:4px solid #8B4513;border-radius:0;overflow:hidden;background:transparent;display:flex;flex-direction:column;padding-bottom:max(env(safe-area-inset-bottom), 20px);padding-top:env(safe-area-inset-top)}
.topHeader{display:flex;flex-direction:column;padding:16px;gap:4px;background:transparent}
.header-section-1{display:flex;align-items:flex-start;gap:16px}
.header-section-2{display:flex;align-items:center;justify-content:space-between;gap:16px;background:rgba(0,0,0,0.4);border-radius:8px;padding:8px 16px;height:40px}
.avatarLarge{width:100px;height:100px;border-radius:8px;object-fit:cover;background:transparent;image-rendering:pixelated}
.friendship-below-avatar{display:flex;align-items:center;gap:8px}
.nameRow{display:flex;align-items:flex-start;justify-content:space-between;gap:8px;margin:0 0 4px 0}
.name{font-size:20px;margin:4px 0 0 0;font-weight:bold;color:#FCEAC7;text-shadow:2px 2px 0px #654321;background:transparent;border:none;padding:0;text-align:left;display:block}
.dateDisplay{font-size:14px;color:#FCEAC7;cursor:default;padding:4px 8px;border:1px solid #FCEAC7;background:rgba(0,0,0,0);border-radius:8px;height:30px;display:inline-flex;align-items:center;justify-content:center;width:auto}
.dateDisplay-left{text-align:left;display:block;margin-left:0}
.dateInfo{margin:0;padding-left:0}
.intro{margin:0 0 8px 0;font-size:14px;color:#FCEAC7;text-shadow:1px 1px 0px #654321}
.dayMeta{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:6px}
.badge{display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:10px;border:2px solid #8B4513;background:transparent;color:#2c2c2c;font-size:12px;font-weight:bold}
.badge .emoji{font-size:14px}
.friendship{display:flex;flex-direction:column;gap:6px}
.friendship-info{display:flex;align-items:center;gap:6px;flex-wrap:wrap}
.friendship-controls{display:flex;align-items:center;justify-content:space-between;gap:8px;margin-top:4px}
.label{color:#FCEAC7;font-size:14px;font-weight:bold;text-shadow:1px 1px 0px #654321}
.points{font-weight:bold;color:#2c2c2c}
.hearts{display:inline-flex;gap:2px;transform:translateY(1px)}
.heart{width:14px;height:14px;image-rendering:pixelated;opacity:.65}
.heart.filled{opacity:1;filter:brightness(1.2) saturate(1.5)}
.content{flex:1;overflow:auto;padding:16px 16px 4px 16px;display:flex;flex-direction:column;gap:12px;position:relative;background:rgba(245,222,179,0.4);border:4px solid #8B4513;margin:4px 16px 16px 16px;border-radius:8px}
.chat{display:flex;flex-direction:column;gap:12px}
.dayStamp{display:flex;align-items:center;justify-content:center;margin:10px 0;color:#2c2c2c;font-size:14px;font-weight:bold}
.dayStamp:before,.dayStamp:after{content:"";flex:1;height:2px;background:#8B4513;margin:0 10px}
.msg{display:flex;gap:12px;align-items:flex-start}
.bubble{max-width:75%;padding:12px 16px;border-radius:8px;font-size:16px;line-height:1.4;border:3px solid #654321;min-height:50px;display:flex;align-items:center;font-weight:bold;text-shadow:1px 1px 0px #654321}
.seb .bubble{background:#DEB887;border-color:#8B4513;color:#2c2c2c}
.me{flex-direction:row-reverse}
.me .bubble{background:#A0522D;border-color:#654321;color:#F5DEB3}
.avatar{width:50px;height:50px;border-radius:8px;object-fit:cover;border:3px solid #654321;background:#8B4513;image-rendering:pixelated}
.meta{margin-top:4px;font-size:11px;color:#9fb3c8}
.progress{margin-top:6px;display:flex;align-items:center;gap:8px;font-size:12px;color:#9fb3c8}
.progress-text{font-size:14px;color:#2c2c2c;font-weight:bold}
.progress-info{font-size:14px;color:#FCEAC7;position:static;font-weight:bold}
.dot{opacity:.6}
.progress-summary{display:flex;align-items:center;gap:6px;padding:4px 16px;background:transparent;justify-content:center}
.composer{padding:8px 16px;background:transparent;position:sticky;bottom:0;z-index:100}
.actions{display:flex;gap:12px;margin-top:0}
.btn{appearance:none;border:4px solid #654321;background:#DEB887;color:#2c2c2c;padding:12px 16px;border-radius:8px;font-size:16px;font-weight:bold;text-shadow:1px 1px 0px #654321;transition:all 0.2s ease;image-rendering:pixelated}
.btn:hover{background:#F5DEB3;transform:translateY(-2px);box-shadow:0 4px 0px #654321}
.primary{background:#CD853F;border-color:#8B4513}
.primary:hover{background:#D2691E}
.btn:disabled{opacity:.6;cursor:not-allowed}
.btn.disabled{opacity:.6;cursor:not-allowed;background:#0f1419;border-color:#1a2330;color:#6b7280}
.btn.icon-btn{padding:8px;min-width:36px;font-size:16px}
.knowledge-btn-header{appearance:none;border:none;background:transparent;padding:4px;border-radius:8px;margin-top:-2px;display:flex;align-items:center;justify-content:center;transition:background-color 0.2s ease}
.knowledge-btn-header:hover{background:rgba(74,222,128,0.1)}
.knowledge-btn{padding:6px 8px;min-width:60px;display:flex;align-items:center;justify-content:center}
.circular-progress{position:relative;display:flex;align-items:center;justify-content:center}
.progress-ring{transform:rotate(-90deg)}
.progress-ring-circle{transition:stroke-dashoffset 0.3s ease}
.progress-text{position:absolute;font-size:10px;font-weight:bold;color:#4ade80;text-shadow:0 0 4px rgba(74,222,128,0.3)}
.circular-progress-large{position:relative;display:flex;align-items:center;justify-content:center}
.progress-text-large{position:absolute;font-size:14px;font-weight:bold;color:#4ade80;text-shadow:0 0 4px rgba(74,222,128,0.3)}
.btn-details{appearance:none;border:3px solid #654321;background:#DEB887;color:#2c2c2c;padding:6px 12px;border-radius:8px;font-size:14px;font-weight:bold;text-shadow:1px 1px 0px #654321}
.btn-details:hover{background:#F5DEB3}
.btn-details-text{appearance:none;border:none;background:transparent;color:#FCEAC7;padding:4px 8px;font-size:14px;font-weight:bold;text-shadow:1px 1px 0px #654321;cursor:pointer;transition:color 0.2s ease}
.btn-details-text:hover{color:#F5DEB3}
.btn-end-day{margin-left:auto}
.quickOptions{position:static;display:flex;flex-wrap:nowrap;gap:6px;padding:0;background:transparent;border:none;border-radius:12px;justify-content:flex-end;align-items:center;max-width:100%;overflow-x:auto;margin-left:auto}
.optionBtn{display:inline-block;width:auto;max-width:220px;text-align:right;padding:6px 8px;background:transparent;border:2px solid #8B4513;color:#2c2c2c;border-radius:8px;font-size:12px;font-weight:bold}
.optionBtn:disabled{opacity:.6}
.sheet{position:fixed;inset:auto 0 0 0;background:#F5DEB3;border-top:4px solid #8B4513;border-left:4px solid #8B4513;border-right:4px solid #8B4513;box-shadow:0 -8px 20px rgba(0,0,0,.3);transform:translateY(100%);transition:transform .2s ease;padding-bottom:env(safe-area-inset-bottom);z-index:200;border-top-left-radius:8px;border-top-right-radius:8px}
.open{transform:translateY(0)}
.hidden{display:none !important}
.sheetHeader{display:flex;align-items:center;justify-content:space-between;padding:16px;border-bottom:4px solid #8B4513;background:#DEB887;color:#2c2c2c;font-weight:bold;font-size:16px}
.giftGrid{padding:16px;display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
.gift{display:flex;flex-direction:column;gap:8px;align-items:center;background:#DEB887;border:3px solid #654321;padding:12px;border-radius:8px;font-size:14px;font-weight:bold;color:#2c2c2c;text-shadow:1px 1px 0px #654321}
.gift img{width:50px;height:50px;border-radius:8px;border:2px solid #654321;background:#8B4513;image-rendering:pixelated}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.7);display:flex;align-items:center;justify-content:center}
.modalCard{width:88%;max-height:70%;overflow:auto;background:#F5DEB3;border:4px solid #8B4513;border-radius:8px}
.modalHeader{display:flex;align-items:center;justify-content:space-between;padding:16px;border-bottom:4px solid #8B4513;background:#DEB887;color:#2c2c2c;font-weight:bold;font-size:18px}
.modalContent{padding:16px;font-size:14px;color:#2c2c2c;font-weight:bold}
.iconBtn{background:transparent;border:none;color:#2c2c2c;font-size:20px;font-weight:bold}
.table{width:100%;border-collapse:separate;border-spacing:0 8px}
.row{display:grid;grid-template-columns:40px 60px 70px 1fr;gap:8px;align-items:center;padding:6px;border:1px solid #223142;border-radius:10px;background:#101822}
.row input,.row select{width:100%;background:#0f1620;border:1px solid #233447;color:#e6edf3;border-radius:8px;padding:6px 8px;font-size:12px}
.row .opts{display:flex;gap:6px;flex-wrap:wrap}
.pill{display:flex;gap:6px;align-items:center;background:#152231;border:1px solid #24435b;border-radius:999px;padding:4px 8px;font-size:12px}
.pill input{width:60px}

/* Toast */
.toast{position:absolute;left:50%;top:72px;transform:translateX(-50%);background:#1c2a3a;border:1px solid #31465e;color:#d9e3ee;padding:8px 12px;border-radius:12px;font-size:13px;opacity:0;pointer-events:none;animation:popfade .9s ease forwards}
@keyframes popfade{0%{opacity:0;transform:translate(-50%, -6px) scale(.98)}20%{opacity:1;transform:translate(-50%, 0) scale(1)}80%{opacity:1}100%{opacity:0;transform:translate(-50%, -10px) scale(.98)}}

.logo {
  height: 6em;
  padding: 1.5em;
  will-change: filter;
  transition: filter 300ms;
}
.logo:hover {
  filter: drop-shadow(0 0 2em #646cffaa);
}
.logo.react:hover {
  filter: drop-shadow(0 0 2em #61dafbaa);
}

@keyframes logo-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@media (prefers-reduced-motion: no-preference) {
  a:nth-of-type(2) .logo {
    animation: logo-spin infinite 20s linear;
  }
}

.card {
  padding: 2em;
}

.read-the-docs {
  color: #888;
}

/* 移动端优化 */
@media (max-width: 480px) {
  .app {
    height: 100vh;
    height: calc(var(--vh, 1vh) * 100); /* 使用JavaScript计算的动态视口高度 */
    height: 100dvh; /* 动态视口高度，避免移动端浏览器UI影响 */
  }
  
  .composer {
    padding-bottom: max(12px, env(safe-area-inset-bottom), 20px);
  }
  
  .sheet {
    padding-bottom: max(20px, env(safe-area-inset-bottom));
  }
  
  /* 确保按钮区域始终可见 */
  .actions {
    margin-bottom: 0;
  }
  
  /* 防止虚拟键盘遮挡 */
  .content {
    padding-bottom: 20px;
  }
}

/* 支持iOS Safari的viewport-fit=cover */
@supports (padding: max(0px)) {
  .app {
    padding-bottom: max(env(safe-area-inset-bottom), 20px);
  }
  
  .composer {
    padding-bottom: max(12px, env(safe-area-inset-bottom), 20px);
  }
}
