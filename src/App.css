*{box-sizing:border-box}
html,body,#root{height:100%}
body{margin:0;background:#0b0f14;color:#e6edf3;font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Apple Color Emoji","Segoe UI Emoji"}
#root{display:flex;align-items:center;justify-content:center}
.app{width:100vw;height:100vh;margin:0;border:1px solid #1f2a34;border-radius:0;overflow:hidden;background:linear-gradient(180deg,#0f1520 0%,#0b0f14 100%);display:flex;flex-direction:column;padding-bottom:max(env(safe-area-inset-bottom), 20px);padding-top:env(safe-area-inset-top)}
.topHeader{display:flex;padding:12px 14px;gap:12px;background:rgba(7,10,14,0.8);backdrop-filter:blur(6px);border-bottom:1px solid #1c2833}
.avatarLarge{width:64px;height:64px;border-radius:16px;object-fit:cover;border:1px solid #2a3b4a;background:#10161d}
.nameRow{display:flex;align-items:baseline;gap:8px}
.name{font-size:18px;margin:0;font-weight:700}
.dateDisplay{font-size:12px;color:#9fb3c8;cursor:pointer;padding:4px 8px;border-radius:6px;transition:background-color 0.2s ease}
.dateDisplay:hover{background:rgba(159,179,200,0.1)}
.dateInfo{margin:8px 0}
.intro{margin:6px 0 8px;font-size:12px;color:#c7d2de}
.dayMeta{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:6px}
.badge{display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:10px;border:1px solid #233447;background:#121a23;color:#cfe0ef;font-size:12px}
.badge .emoji{font-size:14px}
.friendship{display:flex;align-items:center;gap:8px}
.label{color:#9fb3c8;font-size:12px}
.points{font-weight:700}
.hearts{display:inline-flex;gap:2px;transform:translateY(1px)}
.heart{width:16px;height:16px;filter:drop-shadow(0 0 6px rgba(255,98,133,.25));opacity:.65}
.heart.filled{opacity:1}
.content{flex:1;overflow:auto;padding:10px 12px 12px;display:flex;flex-direction:column;gap:8px;position:relative}
.chat{display:flex;flex-direction:column;gap:8px}
.dayStamp{display:flex;align-items:center;justify-content:center;margin:10px 0;color:#9fb3c8;font-size:12px}
.dayStamp:before,.dayStamp:after{content:"";flex:1;height:1px;background:#1c2833;margin:0 10px}
.msg{display:flex;gap:8px;align-items:flex-start}
.bubble{max-width:72%;padding:10px 12px;border-radius:14px;font-size:14px;line-height:1.35;border:1px solid rgba(255,255,255,.06);min-height:40px;display:flex;align-items:center}
.seb .bubble{background:#141b24;border-color:#243140}
.me{flex-direction:row-reverse}
.me .bubble{background:#1d2a39;border-color:#2a3b4a}
.avatar{width:40px;height:40px;border-radius:8px;object-fit:cover;border:1px solid #2a3b4a;background:#10161d}
.meta{margin-top:4px;font-size:11px;color:#9fb3c8}
.progress{margin-top:6px;display:flex;align-items:center;gap:8px;font-size:12px;color:#9fb3c8}
.dot{opacity:.6}
.composer{padding:8px 10px max(12px, env(safe-area-inset-bottom));border-top:1px solid #1c2833;background:rgba(9,13,18,.9);backdrop-filter:blur(6px);position:sticky;bottom:0;z-index:100}
.actions{display:flex;gap:8px;margin-top:10px}
.btn{appearance:none;border:1px solid #2a3b4a;background:#141b24;color:#e6edf3;padding:8px 10px;border-radius:10px;font-size:14px}
.primary{background:#2a3950;border-color:#3b4f69}
.btn:disabled{opacity:.6}
.btn.icon-btn{padding:8px;min-width:36px;font-size:16px}
.knowledge-btn-header{appearance:none;border:none;background:transparent;padding:4px;border-radius:8px;margin-top:8px;display:flex;align-items:center;justify-content:center;transition:background-color 0.2s ease}
.knowledge-btn-header:hover{background:rgba(74,222,128,0.1)}
.knowledge-btn{padding:6px 8px;min-width:60px;display:flex;align-items:center;justify-content:center}
.circular-progress{position:relative;display:flex;align-items:center;justify-content:center}
.progress-ring{transform:rotate(-90deg)}
.progress-ring-circle{transition:stroke-dashoffset 0.3s ease}
.progress-text{position:absolute;font-size:10px;font-weight:bold;color:#4ade80;text-shadow:0 0 4px rgba(74,222,128,0.3)}
.circular-progress-large{position:relative;display:flex;align-items:center;justify-content:center}
.progress-text-large{position:absolute;font-size:14px;font-weight:bold;color:#4ade80;text-shadow:0 0 4px rgba(74,222,128,0.3)}
.btn-details{appearance:none;border:1px solid #2a3b4a;background:#141b24;color:#e6edf3;padding:4px 8px;border-radius:6px;font-size:12px;margin-left:8px}
.btn-details:hover{background:#1a2330}
.btn-end-day{margin-left:auto}
.quickOptions{position:static;display:flex;flex-wrap:nowrap;gap:6px;padding:0;background:transparent;border:none;border-radius:12px;justify-content:flex-end;align-items:center;max-width:100%;overflow-x:auto;margin-left:auto}
.optionBtn{display:inline-block;width:auto;max-width:220px;text-align:right;padding:6px 8px;background:#121922;border:1px solid #203042;color:#dfe7ee;border-radius:10px;font-size:12px}
.optionBtn:disabled{opacity:.6}
.sheet{position:fixed;inset:auto 0 0 0;background:#0e141c;border-top-left-radius:16px;border-top-right-radius:16px;box-shadow:0 -12px 40px rgba(0,0,0,.5);border-top:1px solid #213041;transform:translateY(100%);transition:transform .2s ease;padding-bottom:env(safe-area-inset-bottom);z-index:200}
.open{transform:translateY(0)}
.hidden{display:none !important}
.sheetHeader{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid #1c2833}
.giftGrid{padding:10px 12px 20px;display:grid;grid-template-columns:repeat(4,1fr);gap:10px}
.gift{display:flex;flex-direction:column;gap:6px;align-items:center;background:#131b25;border:1px solid #223142;padding:10px;border-radius:12px;font-size:12px}
.gift img{width:40px;height:40px;border-radius:8px;border:1px solid #2a3b4a;background:#0e141c}
.modal{position:fixed;inset:0;background:rgba(2,6,10,.6);display:flex;align-items:center;justify-content:center}
.modalCard{width:88%;max-height:70%;overflow:auto;background:#0f1620;border:1px solid #223142;border-radius:16px}
.modalHeader{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid #1c2833}
.modalContent{padding:12px 14px;font-size:13px;color:#d3dde6}
.iconBtn{background:transparent;border:none;color:#aab8c7;font-size:16px}
.table{width:100%;border-collapse:separate;border-spacing:0 8px}
.row{display:grid;grid-template-columns:40px 60px 70px 1fr;gap:8px;align-items:center;padding:6px;border:1px solid #223142;border-radius:10px;background:#101822}
.row input,.row select{width:100%;background:#0f1620;border:1px solid #233447;color:#e6edf3;border-radius:8px;padding:6px 8px;font-size:12px}
.row .opts{display:flex;gap:6px;flex-wrap:wrap}
.pill{display:flex;gap:6px;align-items:center;background:#152231;border:1px solid #24435b;border-radius:999px;padding:4px 8px;font-size:12px}
.pill input{width:60px}

/* Toast */
.toast{position:absolute;left:50%;top:72px;transform:translateX(-50%);background:#1c2a3a;border:1px solid #31465e;color:#d9e3ee;padding:8px 12px;border-radius:12px;font-size:13px;opacity:0;pointer-events:none;animation:popfade .9s ease forwards}
@keyframes popfade{0%{opacity:0;transform:translate(-50%, -6px) scale(.98)}20%{opacity:1;transform:translate(-50%, 0) scale(1)}80%{opacity:1}100%{opacity:0;transform:translate(-50%, -10px) scale(.98)}}

.logo {
  height: 6em;
  padding: 1.5em;
  will-change: filter;
  transition: filter 300ms;
}
.logo:hover {
  filter: drop-shadow(0 0 2em #646cffaa);
}
.logo.react:hover {
  filter: drop-shadow(0 0 2em #61dafbaa);
}

@keyframes logo-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@media (prefers-reduced-motion: no-preference) {
  a:nth-of-type(2) .logo {
    animation: logo-spin infinite 20s linear;
  }
}

.card {
  padding: 2em;
}

.read-the-docs {
  color: #888;
}

/* 移动端优化 */
@media (max-width: 480px) {
  .app {
    height: 100vh;
    height: calc(var(--vh, 1vh) * 100); /* 使用JavaScript计算的动态视口高度 */
    height: 100dvh; /* 动态视口高度，避免移动端浏览器UI影响 */
  }
  
  .composer {
    padding-bottom: max(12px, env(safe-area-inset-bottom), 20px);
  }
  
  .sheet {
    padding-bottom: max(20px, env(safe-area-inset-bottom));
  }
  
  /* 确保按钮区域始终可见 */
  .actions {
    margin-bottom: 0;
  }
  
  /* 防止虚拟键盘遮挡 */
  .content {
    padding-bottom: 20px;
  }
}

/* 支持iOS Safari的viewport-fit=cover */
@supports (padding: max(0px)) {
  .app {
    padding-bottom: max(env(safe-area-inset-bottom), 20px);
  }
  
  .composer {
    padding-bottom: max(12px, env(safe-area-inset-bottom), 20px);
  }
}
